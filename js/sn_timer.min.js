if(window.LOADED_TIMER===undefined){var LOADED_TIMER=true;var UNIT_ID=0;var UNIT_NAME=1;var UNIT_TIME=2;var UNIT_AMOUNT=3;var UNIT_LEVEL=4;var UNIT_TIME_FULL=5;var UNIT_IMAGE=6;var UNIT_TIME_DISPLAY_OPTION="displayType";var UNIT_TIME_DISPLAY_OPTION_HUMAN="human";var EVENT_TIME=0;var EVENT_STRING=1;var EVENT_HINT=2;var TIMER_BUILD_QUE_V1=0;var TIMER_COUNTER=1;var TIMER_BUILD_QUE_V2=3;var TIMER_CLOCK_REALTIME=4;var TIMER_EVENT_QUE=5;var sn_timers=new Array();var timer_is_started=false;var timer_is_prepared=false;function sn_timer_prepare(){var c,b,a;if(timer_is_prepared){return}for(b in sn_timers){if(!sn_timers.hasOwnProperty(b)){continue}c=sn_timers[b];c.start_time=timeTimerStart;if(c.type===undefined){c.active=false;continue}c.active=true;c.prefixClass="."+c.id;c.prefixId="#"+c.id;if(c.hasOwnProperty("className")){c.className="."+c.className;c.html_main=$(c.className)}else{c.html_main=$(c.prefixId)}c.options===undefined?c.options={}:false;a=c.options;c.type=parseInt(c.type);switch(c.type){case TIMER_BUILD_QUE_V1:c.html_timer=$(c.prefixId+"_timer");if(!c.html_main.length&&!c.html_timer.length){c.active=false;break}c.always_refresh=c.html_main.length&&!c.html_timer.length;c.changed=true;break;case TIMER_BUILD_QUE_V2:if(!a.que.length){if(a.url!==undefined){document.location=a.url}c.active=false;break}c.slotAmountBarWidthLast=0;c.unit_amount_original=a.que[0][UNIT_AMOUNT];c.html_total_js=$(c.prefixId+"_total:visible");c.html_que_js=$(c.prefixId+"_que");c.html_finish=$(c.prefixId+"_finish:visible");c.html_slots_current=$(c.prefixId+"_slots");c.html_queProgressBar=$(c.prefixId+"_progress_bar");c.html_timer_units=$(c.prefixId+"_units");c.queProgressBarWidth=c.html_queProgressBar.width()?c.html_queProgressBar.width():0;c.html_level_current=$(c.prefixClass+"_level_0:visible");c.html_slotUnitTimeBar=$(c.prefixClass+"_unit_bar_0:visible");c.slotUnitTimeBarWidth=c.html_slotUnitTimeBar.parent().width()?c.html_slotUnitTimeBar.parent().width():0;c.html_timer_current=$(c.prefixClass+"_timer_0:visible");c.slotUnitTimeBarWidthCurrent=-1;c.slotAmountBarWidthCurrent=-1;c.queProgressBarWidthCurrent=-1;c.que_compiled="";break;case TIMER_EVENT_QUE:c.html_total_js=$(c.prefixId+"_total:visible");if(!c.html_main.length&&!c.html_total_js.length){c.active=false;break}c.changed=true;break;case TIMER_COUNTER:a.round=a.round===undefined?0:parseInt(a.round);a.start_value=a.start_value===undefined?0:parseInt(a.start_value);a.per_second=a.per_second===undefined?0:parseFloat(a.per_second);c.current=a.start_value;if(c.html_main.length<=0){c.active=false;break}break;case TIMER_CLOCK_REALTIME:if(c.html_main.length<=0){c.active=false;break}a.format=parseInt(a.format===undefined?a:a.format);a.delta=a.delta===undefined?0:parseInt(a.delta);break;default:c.active=false;break}}timer_is_prepared=true}function sn_timer_compile_que(h){var e=h.options;var g=e.que;var f="";var d=0;var b,c;var a=h.html_que_js.is(":not(:visible)");for(c in g){if(!g.hasOwnProperty(c)){continue}d+=(g[c][UNIT_AMOUNT]-(c==0?1:0))*g[c][UNIT_TIME_FULL];if(a){continue}b=g[c][g[c][UNIT_LEVEL]>0?UNIT_LEVEL:UNIT_AMOUNT];f+=e.template.replace(/\[UNIT_ID\]/gi,g[c][UNIT_ID]).replace(/\[UNIT_TIME\]/gi,sn_timestampToString(g[c][UNIT_TIME])).replace(/\[UNIT_LEVEL\]/gi,b).replace(/\[UNIT_NAME\]/gi,g[c][UNIT_NAME]).replace(/\[UNIT_IMAGE\]/gi,g[c][UNIT_IMAGE]).replace(/\[UNIT_QUE_PLACE\]/gi,c)}e.total=d;!e.total_original?e.total_original=e.total:false;return f}function sn_timer(){if(timer_is_started){window.setTimeout("sn_timer();",1000);return}timer_is_started=true;sn_timer_prepare();var c,l,p,m,h,k,d,n,e,j,g,f;var b=0;var a="";var i=new Date();for(l in sn_timers){if(!sn_timers.hasOwnProperty(l)||!sn_timers[l]["active"]){continue}m="";d="";c=sn_timers[l];h=c.options;g=Math.round((i.valueOf()-c.start_time.valueOf())/1000);switch(c.type){case TIMER_BUILD_QUE_V1:f=h.que;if(f.length){if(f[0][UNIT_TIME]<=g){c.start_time=i;f[0][UNIT_AMOUNT]--;if(f[0][UNIT_AMOUNT]<=0){f.shift();c.changed=true}}}if(f.length&&f[0][UNIT_ID]){m=f[0][UNIT_NAME]+(f[0][UNIT_LEVEL]?" ("+(f[0][UNIT_LEVEL])+")":"");g=Math.round((i.valueOf()-c.start_time.valueOf())/1000);d=sn_timestampToString(-(g)+parseInt(f[0][UNIT_TIME]))}else{m=h.msg_done;c.changed=true;c.active=false}if(c.html_timer.length){c.html_timer.text(d)}else{m+=(m&&d?"<br>":"")+d}if((c.always_refresh||c.changed)&&c.html_main.length){c.html_main.html(m)}break;case TIMER_BUILD_QUE_V2:a="";c.start_time=i;f=h.que;f[0][UNIT_TIME]-=g;if(f[0][UNIT_TIME]<=0){g=-f[0][UNIT_TIME];f[0][UNIT_AMOUNT]--;if(f[0][UNIT_AMOUNT]<=0){f.shift();c.que_compiled=""}else{f[0][UNIT_TIME]=f[0][UNIT_TIME_FULL];h.total-=f[0][UNIT_TIME_FULL];c.html_level_current.text(f[0][UNIT_AMOUNT]);c.slotAmountBarWidthCurrent=Math.percentPixels(f[0][UNIT_AMOUNT],c.unit_amount_original,c.slotUnitTimeBarWidth)}}else{g=0}if(!c.que_compiled){c.que_compiled=sn_timer_compile_que(c);c.html_slots_current.length?c.html_slots_current.html(f.length):false;c.html_que_js.length?c.html_que_js.html(c.que_compiled):false;c.html_level_current=$(c.prefixClass+"_level_0:visible");c.html_timer_seconds=$(c.prefixClass+"_seconds_0:visible");c.html_timer_current=$(c.prefixClass+"_timer_0:visible");c.html_slotUnitTimeBar=$(c.prefixClass+"_unit_bar_0:visible");c.slotUnitTimeBarWidth=c.html_slotUnitTimeBar.parent().width()?c.html_slotUnitTimeBar.parent().width():0;c.html_slotAmountBar=$(c.prefixClass+"_slot_bar_0:visible")}if(f.length&&f[0][UNIT_ID]){f[0][UNIT_TIME]-=g;j=f[0][UNIT_TIME]<=0?1:f[0][UNIT_TIME];m=f[0][UNIT_NAME];a="("+f[0][f[0][UNIT_LEVEL]?UNIT_LEVEL:UNIT_AMOUNT]+")";if(c.hasOwnProperty("options")&&c.options.hasOwnProperty(UNIT_TIME_DISPLAY_OPTION)&&c.options[UNIT_TIME_DISPLAY_OPTION]===UNIT_TIME_DISPLAY_OPTION_HUMAN){d=sn_timestampToStringHuman(j);p=sn_timestampToStringHuman(j+h.total)}else{d=sn_timestampToString(j);p=sn_timestampToString(j+h.total)}if(!c.html_finish.already_tagged&&c.html_finish.length){c.html_finish.html(snDateToString(new Date(timeBrowser.valueOf()+(j+h.total)*1000),7));c.html_finish.already_tagged=true}c.slotUnitTimeBarWidthCurrent=Math.percentPixels(j,f[0][UNIT_TIME_FULL],-c.slotUnitTimeBarWidth);c.queProgressBarWidthCurrent=Math.percentPixels(j+h.total,f[0][UNIT_TIME_FULL]+h.total_original,c.queProgressBarWidth)}else{if(h.url!==undefined){document.location=h.url}j=0;m=h.msg_done;$(c.prefixClass+"_hide_on_complete").hide();c.active=false}var o=Math.round((j%60+1)/60*100);o>100?o=100:false;c.html_timer_seconds.length?c.html_timer_seconds.width(o+"%"):false;if(c.html_total_js.length){c.html_total_js.html(p)}else{d+=(d?"<br />":"")+p}if(c.html_timer_units.length){c.html_timer_units.html("<span>"+a+"</span>")}else{m&&a?m+="<br />"+a:false}if(c.html_timer_current.length){c.html_timer_current.html("<span>"+d+"</span>")}else{m+=(m&&d?"<br />":"")+d}if(!PLAYER_OPTION_PROGRESS_BARS_DISABLED){if(c.html_queProgressBar.length&&c.queProgressBarWidthCurrent!=c.queProgressBarWidthLast){c.html_queProgressBar.css("width",c.queProgressBarWidthLast=c.queProgressBarWidthCurrent)}if(c.html_slotUnitTimeBar.length&&c.slotUnitTimeBarWidthCurrent!=c.slotUnitTimeBarWidthLast){c.html_slotUnitTimeBar.css("width",c.slotUnitTimeBarWidthLast=c.slotUnitTimeBarWidthCurrent)}if(c.html_slotAmountBar.length&&c.slotAmountBarWidthCurrent!=c.slotAmountBarWidthLast){c.html_slotAmountBar.css("width",c.slotAmountBarWidthLast=c.slotAmountBarWidthCurrent)}}if(!jQuery.fx.off&&f.length){if(f[0][UNIT_TIME]==1&&f[0][UNIT_AMOUNT]==1){$(c.prefixClass+"_container_0:visible").animate({opacity:0},f[0][UNIT_TIME]*1000)}if(f[0][UNIT_TIME_FULL]==j){c.html_timer_current.children().animate({opacity:0},50,function(){$(this).animate({opacity:1},300)})}}c.html_main.length&&m!=c.infoText?c.html_main.html(c.infoText=m):false;break;case TIMER_EVENT_QUE:e="";if(h.que.length&&h.que[0][EVENT_TIME]<=g){h.que.shift();c.changed=true}if(h.que.length){if(c.changed){m=h.que[0][EVENT_STRING];e=h.que[0][EVENT_HINT]}}else{m=h.msg_done;c.changed=true;c.active=false}if(c.changed){c.html_main.length?c.html_main.html(m):false;c[c.html_total_js.length?"html_total_js":"html_main"].prop("title",e);c.changed=false}break;case TIMER_COUNTER:if(h.per_second==0){n=h.start_value;c.active=false}else{n=h.start_value+g*h.per_second;if(n<0){n=0;c.active=false}else{if(n>=h.max_value&&h.per_second>0){n=Math.max(h.start_value,h.max_value);c.active=false}}}m=sn_format_number(n,h.round,"positive",h.max_value);c.current=n;if(c.hasOwnProperty("className")){$(c.className).html(m)}else{c.html_main.html(m)}break;case TIMER_CLOCK_REALTIME:k=new Date(i.valueOf()+h.delta*1000);c.html_main.text(snDateToString(k,h.format));break}b++}if(b){window.setTimeout("sn_timer();",1000)}timer_is_started=false}}function timerById(c){var b=null;for(var a in sn_timers){if(!sn_timers.hasOwnProperty(a)){continue}if(sn_timers[a].id==c){b=sn_timers[a];break}}return b};